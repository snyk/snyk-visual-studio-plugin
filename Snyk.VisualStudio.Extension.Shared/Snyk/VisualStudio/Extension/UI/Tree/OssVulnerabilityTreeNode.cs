namespace Snyk.VisualStudio.Extension.UI.Tree
{
    using Snyk.VisualStudio.Extension.CLI;

    /// <summary>
    /// Scan vulnerability tree node.
    /// </summary>
    public class OssVulnerabilityTreeNode : TreeNode
    {
        /// <summary>
        /// Gets a value indicating whether title.
        /// If it's parent title it display project name with target CLI file.
        /// If it's leaf node it's display vulnerability package name and title.
        /// </summary>
        public override string Title
        {
            get
            {
                string title = string.Empty;

                if (this.Vulnerabilities != null)
                {
                    title = this.Vulnerabilities.ProjectName + "\\" + this.Vulnerabilities.DisplayTargetFile;
                }

                if (this.Vulnerability != null)
                {
                    title = this.Vulnerability.GetPackageNameTitle();
                }

                return title;
            }
        }

        /// <summary>
        /// Gets a value indicating whether icon for node.
        /// If it's parent node it will get package manager icon.
        /// If it's leaf node it will display vulnerability severity icon.
        /// </summary>
        public override string Icon
        {
            get
            {
                if (this.Vulnerability != null)
                {
                    return SnykIconProvider.GetSeverityIcon(this.Vulnerability.Severity);
                }

                return SnykIconProvider.GetPackageManagerIcon(this.Vulnerabilities.PackageManager);
            }
        }

        /// <summary>
        /// Gets or sets a value indicating whether Vulnerability for this node.
        /// </summary>
        public Vulnerability Vulnerability { get; set; }

        /// <summary>
        /// Gets or sets a value indicating whether CliGroupedVulnerabilities if it's parent node.
        /// </summary>
        public CliGroupedVulnerabilities Vulnerabilities { get; set; }
    }
}
